> 💡 **한 줄 요약**
>
> 가상 돔을 통해 변경된 부분을 파악하여 변경된 모든 엘리먼트를 실제 돔에 한꺼번에 적용시켜 효율적인 렌더링을 할 수 있다.

### 1. 🤔 왜 사용하는가

- **DOM (Document Object Model)**

  - HTML 문서 구조를 객체로 표현
  - 웹 페이지의 제목, 사진 같은 요소를 트리 구조로 표현한 것
  - JS로 돔 조작 가능 → 엘리먼트의 구조 및 스타일 변경 가능
  - 브라우저의 DOM은 구적으로 복잡
    - 직접 조작하는 작업은 성능 비용이 상당히 높음

- **Virtual DOM**
  - 실제 DOM을 JS 객체 형태로 복제한 가벼운 복사본
  - JavaScript 객체 형태로 메모리에 저장됨
  - 실제 돔의 모든 엘리먼트와 속성 포함하고 있지만, 브라우저의 돔에 직접 접근 불가능
  - 웹 애플리케이션의 성능 최적화위해 등장
  - 핵심
    - 상태 변경이 발생할 때마다 전체 UI를 Virtual DOM에 반영
    - 이를 이전 상태와 비교해 필요한 부분에 한해 최소한의 DOM 업데이트를 수행하는 것
  - Virtual DOM 업데이트 및 비교
    - 실제 DOM을 조작하지 않고 메모리 상에서 업데이트와 비교
      → 가볍고 빠름

### 2. 💡 무엇인지 아는가(특징)

- **실제 DOM 조작의 복잡성**

  - 브라우저는 HTML 탐색 → 해당 엘리먼트 찾음 → 엘리먼트 교체 → 수정된 내용에 따라 CSS 다시 계산 → 브라우저를 다시 그려줌 → 복잡성 증가
  - 리스트 스타일을 각각 변경할 경우 여러 번 반복되어 비효율적

- **리액트의 가상 돔 활용**
  - 두 개의 가상 돔 객체를 사용해 화면 구조 관리
    (렌더링 이전의 구조, 렌더링 이후의 구조)
  - state 변경 시 가상 돔 업데이트해 화면을 새로 렌더링
  - 두 개의 가상 돔 비교해 변경된 엘리먼트 파악
  - 파악한 엘리먼트를 실제 돔에 적용
  - 배치 업데이트를 사용해 모든 변경을 집답으로 적용함
    → 돔 조작의 효율성 극대화
- **가상 돔 활용 과정**

  - **DOM 조작** : 웹 페이지의 구조나 요소를 수정하는 과정
  - **렌더링** : 웹 페이지의 정보를 실제 화면에 표시하는 과정
  - **상태 변경** : 웹 애플리케이션이나 웹 페이지의 내용이나 구조가 변화하는 것
    - 컴포넌트의 상태나 props 변경 시 Virtual DOM이 다시 생성됨
  - **재조정(Reconciliation)** : 비교 알고리즘을 이용해 새로운 Virtual DOM과 이전 Virtual DOM 간의 차이 계산
  - **re-render** : 계산된 차이에 따라 실제 DOM에서 필요한 부분만 업데이트
  - **디프(Deep)** : 두 개의 객체나 상태를 비교해 어느 부분이 변경되었는지 찾는 과정
  - **배치 업데이트** : 여러 변화 있을 때, 한 번의 작업으로 여러 요소 동시에 업데이트하는 과정
  - **리컬스텔레이션** : 배치 업데이트를 수행해 변경된 모든 엘리먼트를 실제 돔에 한꺼번에 적용하는 과정

- **React의 비교(diffing) 알고리즘 효율화 방법**
  - React는 $O(n^3)$의 복잡도를 가질 수 있는 트리 비교 문제를, 휴리스틱을 통해 $O(n)$으로 최적화함
- **휴리스틱 알고리즘의 가정**
  1. **서로 다른 타입의 두 요소는 서로 다른 트리 만들어냄**
     - DOM 요소의 타입이 다르면 비교를 수행하지 않고, 해당 요소와 그 자식들을 모두 새로 생성함
       - 자식 요소들의 내용이 같더라도 이전의 트리를 모두 버리고 완전히 새로 생성
       - 애플리케이션에서 타입이 다를 경우 보통 완전히 다른 컴포넌트로 교체되는 상황이 많기에 대부분의 경우 효율적임
     - 동일한 타입의 요소라면 동일한 내역은 유지하고, 변경된 속성만 갱신
  2. **개발자가 `key` prop을 통해, 여러 렌더링 사이에서 어떤 자식 엘리먼트가 변경되지 않아야 할지 표시 가능**
     - 같은 레벨의 자식들을 비교할 때 개발자가 입력한 `key` prop을 사용해 요소 식별
       - 리스트 내역의 일부가 수정되었을 때 모든 아이템 요소들을 불필요하게 갱신하지 않음
       - 실제 변경된 요소만 감지해 효율적으로 갱신함

### 3. ✅ 장점

- 가상 돔을 활용해 효율적인 화면 렌더링을 할 수 있음
- DOM 조작의 비용 절감
- 브라우저 렌더링 성능 개선

### 4. ⚠️ 단점

- 일반 DOM 조작은 복잡함
